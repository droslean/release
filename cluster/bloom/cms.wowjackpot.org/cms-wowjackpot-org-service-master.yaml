apiVersion: apps/v1
kind: Deployment
metadata:
  name: cms-wowjackpot-org
  namespace: affwebsites
  labels:
    deployer.ginbits.com/org: ginbits
    deployer.ginbits.com/repo: bloom
    deployer.ginbits.com/branch: master
    deployer.ginbits.com/image: cms.wowjackpot.org
    domain: cms.wowjackpot.org
spec:
  replicas: 1
  selector:
    matchLabels:
      domain: cms.wowjackpot.org
  template:
    metadata:
      labels:
        domain: cms.wowjackpot.org
    spec:
      imagePullSecrets:
      - name: regcred
      containers:
      - name: website
        image: ghcr.io/ginbits/bloom/cms.wowpotjackpot.org:master
        imagePullPolicy: Always
        volumeMounts:
        - mountPath: /var/www/html/.env
          name: cms-wowjackpot-org-env
          subPath: .env
        - mountPath: /var/www/html/auth.json
          name: composer-creds
          subPath: auth.json
      volumes:
      - name: cms-wowjackpot-org-env
        secret:
          secretName: cms-wowjackpot-org-env
      - name: composer-creds
        secret:
          secretName: composer-creds
---
apiVersion: v1
kind: Service
metadata:
  name: cms-wowjackpot-org
  namespace: affwebsites
spec:
  selector:
    domain: cms.wowjackpot.org
  ports:
  - name: http
    port: 8080
    protocol: TCP
  type: NodePort
